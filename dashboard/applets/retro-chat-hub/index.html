<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dialogue Studio</title>
    <link rel="icon" type="image/svg+xml" href="./assets/icon.svg" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="retro-chat" data-provider="openai">
      <header class="retro-chat__header">
        <div class="retro-chat__identity">
          <img src="./assets/icon.svg" alt="Dialogue Studio icon" class="retro-chat__icon" />
          <div>
            <h1 class="retro-chat__title">Dialogue Studio</h1>
            <p class="retro-chat__subtitle">A calm, uncluttered workspace for thoughtful conversations.</p>
          </div>
        </div>
        <div class="retro-chat__header-meta">
          <p class="retro-chat__status" id="connectionStatus" role="status" aria-live="polite">Offline ‚Äì add an API key to sync models.</p>
          <div class="retro-chat__controls" role="group" aria-label="Workspace panels">
            <button type="button" class="icon-button" data-panel-target="chats">Chats</button>
            <button type="button" class="icon-button" data-panel-target="settings">Session</button>
            <button type="button" class="icon-button" data-panel-target="insights">Insights</button>
          </div>
        </div>
      </header>

      <section class="retro-chat__content" aria-label="Chat workspace">
        <section class="chat-panel" aria-label="Chat timeline">
          <div class="chat-panel__header">
            <div class="chat-panel__meta">
              <span id="activeChatTitle">Untitled session</span>
              <span id="chatMeta" class="chat-panel__meta-tag">0 messages</span>
            </div>
            <div class="chat-panel__indicators" id="typingIndicator" aria-live="polite"></div>
          </div>
          <div class="chat-panel__messages" id="messageList" aria-live="polite"></div>
          <div class="chat-panel__status" id="summaryStatus" aria-live="polite"></div>
        </section>

        <form class="composer" id="composer" autocomplete="off">
          <div class="composer__row">
            <button type="button" id="voiceButton" class="composer__icon" aria-label="Start voice input">üéôÔ∏è</button>
            <textarea id="messageInput" rows="3" placeholder="Ask anything you'd like help with"></textarea>
            <label class="composer__icon composer__icon--file" for="imageInput" aria-label="Add images">
              <input type="file" id="imageInput" accept="image/*" multiple />
              <span aria-hidden="true">üìé</span>
            </label>
          </div>
          <div class="composer__meta">
            <div class="composer__hint" id="voiceStatus" aria-live="polite"></div>
            <div class="composer__attachments" id="attachmentPreview" aria-live="polite"></div>
            <button type="submit" id="sendButton" class="composer__send">Send</button>
          </div>
        </form>
      </section>
    </main>

    <div class="workspace-drawer" id="panel-chats" data-panel aria-hidden="true">
      <div class="workspace-drawer__backdrop" data-close-panel></div>
      <aside class="workspace-drawer__surface" role="dialog" aria-modal="true" aria-labelledby="chatsPanelTitle" tabindex="-1" data-panel-surface>
        <div class="workspace-drawer__header">
          <h2 id="chatsPanelTitle">Saved chats</h2>
          <button type="button" class="icon-button" data-close-panel aria-label="Close saved chats">‚úï</button>
        </div>
        <div class="workspace-drawer__body">
          <div class="sidebar__actions">
            <button id="newChatButton" class="pixel-button pixel-button--primary">New chat</button>
            <button id="clearAllButton" class="pixel-button" aria-label="Delete all saved chats">Clear all</button>
          </div>
          <div class="sidebar__toggles">
            <label class="toggle">
              <input type="checkbox" id="rememberKeysToggle" />
              <span>Remember API keys</span>
            </label>
          </div>
          <nav class="sidebar__list" id="conversationList" aria-live="polite"></nav>
        </div>
      </aside>
    </div>

    <div class="workspace-drawer" id="panel-settings" data-panel aria-hidden="true">
      <div class="workspace-drawer__backdrop" data-close-panel></div>
      <section class="workspace-drawer__surface" role="dialog" aria-modal="true" aria-labelledby="settingsPanelTitle" tabindex="-1" data-panel-surface>
        <div class="workspace-drawer__header">
          <h2 id="settingsPanelTitle">Session settings</h2>
          <button type="button" class="icon-button" data-close-panel aria-label="Close session settings">‚úï</button>
        </div>
        <div class="workspace-drawer__body">
          <div class="provider-panel" aria-label="Model provider controls">
            <div class="provider-panel__tabs" role="tablist">
              <button role="tab" aria-selected="true" data-provider="openai" class="provider-tab">OpenAI</button>
              <button role="tab" aria-selected="false" data-provider="gemini" class="provider-tab">Gemini</button>
            </div>
            <div class="provider-panel__settings">
              <label class="provider-field">
                <span class="provider-field__label">API key</span>
                <input type="password" id="apiKeyInput" placeholder="sk-..." autocomplete="off" />
              </label>
              <div class="provider-field provider-field--button">
                <button id="loadModelsButton" class="pixel-button">Refresh models</button>
                <span id="modelStatus" class="provider-field__hint" aria-live="polite"></span>
              </div>
              <label class="provider-field">
                <span class="provider-field__label">Model</span>
                <select id="modelSelect" aria-label="Available models"></select>
              </label>
              <label class="provider-field">
                <span class="provider-field__label">Temperature</span>
                <input type="number" id="temperatureInput" min="0" max="2" step="0.1" value="0.7" />
              </label>
              <label class="provider-field provider-field--textarea">
                <span class="provider-field__label">Assistant instructions</span>
                <textarea id="systemPromptInput" rows="4" placeholder="You are a precise, kind assistant. Provide clear, grounded answers."></textarea>
                <span class="provider-field__hint">Saved per provider. Leave blank for the default helper voice.</span>
              </label>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div class="workspace-drawer" id="panel-insights" data-panel aria-hidden="true">
      <div class="workspace-drawer__backdrop" data-close-panel></div>
      <section class="workspace-drawer__surface" role="dialog" aria-modal="true" aria-labelledby="insightsPanelTitle" tabindex="-1" data-panel-surface>
        <div class="workspace-drawer__header">
          <h2 id="insightsPanelTitle">Session insights</h2>
          <button type="button" class="icon-button" data-close-panel aria-label="Close insights">‚úï</button>
        </div>
        <div class="workspace-drawer__body">
          <div class="insights-panel" aria-label="Session insights">
            <div class="insights-panel__header">
              <button id="renameChatButton" class="pixel-button pixel-button--ghost">Rename chat</button>
            </div>
            <ul class="insights-panel__stats" id="insightStats"></ul>
            <div class="insights-panel__summary" id="insightSummary">Start chatting to see highlights and recaps.</div>
            <div class="insights-panel__footer" id="insightFooter"></div>
          </div>
        </div>
      </section>
    </div>
    <script src="./app.js" defer></script>
  </body>
</html>
